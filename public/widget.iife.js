(function(){"use strict";const l=[{id:"price",label:"Price is too high"},{id:"shipping",label:"Shipping is too expensive"},{id:"browsing",label:"Just browsing"},{id:"other",label:"Other"}];function c(r,{onSelect:o,onClose:t}){if(r.querySelector(".widget-overlay"))return;const e=document.createElement("div");e.className="widget-overlay";const i=document.createElement("div");i.className="widget-container",i.innerHTML=`
    <button class="widget-close" aria-label="Close survey">&times;</button>
    <div class="widget-header">
      <h3 class="widget-title">Quick question before you go...</h3>
      <p style="margin: 8px 0 0; color: #666;">What stopped you from buying today?</p>
    </div>
    <div class="widget-options">
      ${l.map(s=>`
        <button class="widget-option" data-reason="${s.id}">
          ${s.label}
        </button>
      `).join("")}
    </div>
  `,e.appendChild(i),r.appendChild(e),requestAnimationFrame(()=>{e.classList.add("visible")});const a=s=>{if(s.target.closest(".widget-close")){n();return}if(s.target===e){n();return}const d=s.target.closest(".widget-option");if(d){const m=d.dataset.reason;n(()=>o(m))}};e.addEventListener("click",a);function n(s){e.classList.remove("visible"),e.addEventListener("transitionend",()=>{e.remove(),s?s():t()},{once:!0})}}function u(r,o){let t=document.getElementById(r);if(t||(t=document.createElement("div"),t.id=r,document.body.appendChild(t)),t.shadowRoot)return t.shadowRoot;const e=t.attachShadow({mode:"open"});{const i=document.createElement("style");i.textContent=o,e.appendChild(i)}return e}const g={init(r,o={}){const{threshold:t=10,minTimeOnPage:e=2e3}=o;let i=!1;setTimeout(()=>{i=!0},e);const a=n=>{i&&n.clientY<=t&&r()};return document.documentElement.addEventListener("mouseleave",a),document.addEventListener("mouseout",n=>{!n.toElement&&!n.relatedTarget&&a(n)}),()=>{document.documentElement.removeEventListener("mouseleave",a),document.removeEventListener("mouseout",a)}}},p=":host{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-size:14px;line-height:1.5;color:#333;box-sizing:border-box}*,*:before,*:after{box-sizing:inherit}.widget-overlay{position:fixed;top:0;left:0;width:100vw;height:100vh;background-color:#0006;z-index:2147483647;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s ease-in-out;pointer-events:none}.widget-overlay.visible{opacity:1;pointer-events:auto}.widget-container{background:#fff;width:90%;max-width:400px;padding:24px;border-radius:12px;box-shadow:0 10px 25px #00000026;transform:translateY(20px);transition:transform .2s ease-in-out}.widget-overlay.visible .widget-container{transform:translateY(0)}.widget-header{margin-bottom:16px;text-align:center}.widget-title{font-size:18px;font-weight:600;margin:0;color:#1a1a1a}.widget-options{display:flex;flex-direction:column;gap:8px}.widget-option{padding:10px 16px;border:1px solid #e0e0e0;border-radius:8px;background:#fff;cursor:pointer;text-align:left;transition:all .15s ease;font-size:14px}.widget-option:hover{border-color:#333;background-color:#f9f9f9}.widget-close{position:absolute;top:12px;right:12px;background:none;border:none;font-size:20px;cursor:pointer;color:#999;padding:4px;line-height:1}.widget-close:hover{color:#333}",h="lost-sale-survey-widget";class v{constructor(){if(window.__LOST_SALE_WIDGET_INSTANCE__)return window.__LOST_SALE_WIDGET_INSTANCE__;this.init(),window.__LOST_SALE_WIDGET_INSTANCE__=this}init(){console.log("[SurveyWidget] Initializing..."),this.shadowRoot=u(h,p),this.setupTriggers()}setupTriggers(){window.LostSale={open:()=>this.showSurvey()},this.cleanupExit=g.init(()=>{console.log("[SurveyWidget] Exit intent detected"),this.showSurvey()}),console.log("[SurveyWidget] Initialized with Exit Intent protection.")}showSurvey(){this.isOpen||(this.isOpen=!0,c(this.shadowRoot,{onSelect:o=>{console.log("[SurveyWidget] Reason selected:",o),this.closeSurvey()},onClose:()=>{this.closeSurvey()}}))}closeSurvey(){if(!this.isOpen)return;this.isOpen=!1;const o=this.shadowRoot.querySelector(".widget-overlay");o&&(o.dataset.visible="false")}}new v})();
//# sourceMappingURL=widget.iife.js.map
